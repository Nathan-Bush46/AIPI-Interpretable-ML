<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="style.css" />
  <title>Responsible AI ‚Äì Bias Exhibit</title>
</head>

<body>

<!-- SIDEBAR -->
<aside class="sidebar">
  <h3>Navigation</h3>
  <a href="index.html">üè† Home</a>
  <a href="about.html">‚ÑπÔ∏è About the Models</a>
  <a href="prompts.html">üìù View Prompts</a>
</aside>

<!-- DARK MODE TOGGLE -->
<button id="theme-toggle">üåô</button>

<!-- NAVBAR -->
<nav class="navbar">
  <a href="index.html" class="nav-item">Home</a>
  <a href="about.html" class="nav-item">About</a>
  <a href="prompts.html" class="nav-item">Prompts</a>
</nav>

<header>
  <h1>Responsible AI Image Bias Exhibit</h1>
  <p>
    How different generative models interpret identical neutral prompts.  
    Inherent gender and race bias appears baked into the models.
  </p>
</header>


<!-- MODEL FILTER BAR -->
<div id="model-filter">
  <button class="filter-btn active" data-model="all">Show All</button>
  <button class="filter-btn" data-model="flux">Flux</button>
  <button class="filter-btn" data-model="ideogram">Ideogram</button>
  <button class="filter-btn" data-model="imagen">Imagen</button>
  <button class="filter-btn" data-model="seedream">Seedream</button>
  <button class="filter-btn" data-model="stable">Stable</button>
</div>

<!-- IMAGE GALLERY -->
<div id="gallery"></div>

<!-- FULLSCREEN VIEWER -->
<div id="fullscreen-viewer">
  <div id="fs-backdrop"></div>

  <div id="fs-content">
    <img id="fs-image" src="" />
    <h2 id="fs-title"></h2>
    <p id="fs-note"></p>

    <!-- Controls -->
    <button id="fs-close">‚úï</button>
    <button id="fs-caption-toggle">Show/Hide Caption</button>

    <!-- Prev/Next Arrows -->
    <button id="fs-prev" class="nav-btn">‚ü®</button>
    <button id="fs-next" class="nav-btn">‚ü©</button>
  </div>
</div>

<script>
/* --------------------------
   THEME MODE LOGIC
--------------------------- */
const toggle = document.getElementById("theme-toggle");

function applyTheme() {
  const saved = localStorage.getItem("theme");
  if (saved === "dark") {
    document.body.classList.add("dark");
    toggle.textContent = "‚òÄÔ∏è";
  }
}

applyTheme();

toggle.onclick = () => {
  document.body.classList.toggle("dark");
  const mode = document.body.classList.contains("dark") ? "dark" : "light";
  toggle.textContent = mode === "dark" ? "‚òÄÔ∏è" : "üåô";
  localStorage.setItem("theme", mode);
};

/* --------------------------
   LOAD GALLERY FROM index.json
--------------------------- */
async function loadGallery() {
  const res = await fetch("images/index.json");
  const data = await res.json();
  const gallery = document.getElementById("gallery");

  for (const sectionName in data) {
    const section = data[sectionName];

    const block = document.createElement("div");
    block.className = "section-block";

    block.innerHTML = `
      <h2>${sectionName.toUpperCase()}</h2>
      <p class="section-description">${section.description}</p>
      <p class="section-takeaway"><strong>Takeaway:</strong> ${section.takeaway}</p>
      <div class="image-row"></div>
    `;

    const row = block.querySelector(".image-row");

    for (const modelName in section.images) {
      const item = section.images[modelName];

      const card = document.createElement("div");
      card.className = "image-card";
      card.dataset.model = modelName;

      card.innerHTML = `
        <img src="images/${sectionName}/${item.file}" alt="${modelName}">
        <div class="info">
          <h3>${modelName}</h3>
          <p>${item.bias_note}</p>
        </div>
      `;

      card.addEventListener("click", () => card.classList.toggle("clicked"));
      row.appendChild(card);
    }

    gallery.appendChild(block);
  }
}

loadGallery();

/* --------------------------
   MODEL FILTER
--------------------------- */
document.addEventListener("click", (e) => {
  if (!e.target.classList.contains("filter-btn")) return;

  const selected = e.target.dataset.model;
  const cards = document.querySelectorAll(".image-card");

  document.querySelectorAll(".filter-btn").forEach((btn) =>
    btn.classList.remove("active")
  );
  e.target.classList.add("active");

  cards.forEach((card) => {
    card.style.display =
      selected === "all" || card.dataset.model === selected ? "block" : "none";
  });
});

/* --------------------------
   FULLSCREEN VIEWER LOGIC
--------------------------- */
const viewer = document.getElementById("fullscreen-viewer");
const fsImg = document.getElementById("fs-image");
const fsTitle = document.getElementById("fs-title");
const fsNote = document.getElementById("fs-note");
const fsClose = document.getElementById("fs-close");

let currentCards = [];
let currentIndex = 0;

// Open fullscreen
document.addEventListener("click", (e) => {
  const card = e.target.closest(".image-card");
  if (!card) return;

  currentCards = [...document.querySelectorAll(".image-card")].filter(
    (c) => c.style.display !== "none"
  );

  currentIndex = currentCards.indexOf(card);

  openFullscreen(card);
});

// Extract + display
function openFullscreen(card) {
  const img = card.querySelector("img").src;
  const title = card.querySelector(".info h3").textContent;
  const note = card.querySelector(".info p").textContent;

  fsImg.src = img;
  fsTitle.textContent = title;
  fsNote.textContent = note;

  viewer.style.display = "flex";
}

// Close fullscreen
fsClose.onclick = () => (viewer.style.display = "none");
document.getElementById("fs-backdrop").onclick = () =>
  (viewer.style.display = "none");

document.addEventListener("keydown", (e) => {
  if (viewer.style.display === "none") return;
  if (e.key === "Escape") viewer.style.display = "none";
});

// Navigation arrows
function showNext() {
  currentIndex = (currentIndex + 1) % currentCards.length;
  openFullscreen(currentCards[currentIndex]);
}

function showPrev() {
  currentIndex = (currentIndex - 1 + currentCards.length) % currentCards.length;
  openFullscreen(currentCards[currentIndex]);
}

document.getElementById("fs-next").onclick = showNext;
document.getElementById("fs-prev").onclick = showPrev;

// Keyboard navigation
document.addEventListener("keydown", (e) => {
  if (viewer.style.display === "none") return;
  if (e.key === "ArrowRight") showNext();
  if (e.key === "ArrowLeft") showPrev();
});

// Caption toggle
document.getElementById("fs-caption-toggle").onclick = () => {
  fsNote.style.display = fsNote.style.display === "none" ? "block" : "none";
};
</script>

<footer class="site-footer">
  <p>
    Created by Nathan Bush ¬∑
    <a href="mailto:nathanbush46@gmail.com">nathanbush46@gmail.com</a>
  </p>
</footer>


</body>
</html>
